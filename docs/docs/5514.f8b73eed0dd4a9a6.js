"use strict";(self.webpackChunkmybatboo=self.webpackChunkmybatboo||[]).push([[5514],{5514:(I,u,e)=>{e.r(u),e.d(u,{CropManagementComponent:()=>L});var E=e(974),_=e(1135),C=e(3900),l=e(8505),x=e(4004),f=e(262),M=e(9646),r=e(5649),d=e(9401),h=e(8484),y=e(9300),t=e(2223),O=e(8615),v=e(8740),p=e(6921),P=e(7204),m=e(4755);function D(a,s){1&a&&(t.TgZ(0,"div",11),t._uU(1," \ubcd1\ud574 \uc9c4\ub2e8 \ud6c4 \uce74\ud14c\uace0\ub9ac\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc740 \uc791\ubb3c\ub4e4\uc785\ub2c8\ub2e4. "),t.qZA())}function A(a,s){if(1&a){const n=t.EpF();t.TgZ(0,"div",12)(1,"mp-button",13),t.NdJ("click",function(i){t.CHM(n);const c=t.oxw().$implicit,g=t.oxw(2);return t.KtG(g.editCategory(c,i))}),t._UZ(2,"mp-icon",14),t.qZA(),t.TgZ(3,"mp-button",15),t.NdJ("click",function(i){t.CHM(n);const c=t.oxw().$implicit,g=t.oxw(2);return t.KtG(g.deleteCategory(c.id,i))}),t._UZ(4,"mp-icon",16),t.qZA()()}}function T(a,s){if(1&a){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",6),t.NdJ("click",function(){const c=t.CHM(n).$implicit,g=t.oxw(2);return t.KtG(g.openRecordList(c))}),t.TgZ(2,"div",7)(3,"span"),t._uU(4),t.ALo(5,"categoryName"),t.qZA(),t._UZ(6,"mp-icon",8),t.qZA(),t.YNc(7,D,2,0,"div",9),t.YNc(8,A,5,0,"div",10),t.qZA(),t.BQk()}if(2&a){const n=s.$implicit;t.xp6(4),t.AsE("",t.lcZ(5,4,n.name)," (",n.cnt||0,")"),t.xp6(3),t.Q6J("ngIf","unclassified"===n.name),t.xp6(1),t.Q6J("ngIf","unclassified"!==n.name)}}function B(a,s){if(1&a&&(t.TgZ(0,"div",4),t.YNc(1,T,9,6,"ng-container",5),t.qZA()),2&a){const n=s.ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}let L=(()=>{class a extends r.NT{constructor(n,o,i,c){super(),this.api=n,this.bottomSheet=o,this.alert=i,this.toast=c,this.loader$=new _.X(null),this.status$=new _.X(r.Lr.INITIAL),this.categories$=this.loader$.pipe((0,C.w)(()=>this.api.loadUserCategories())),this.currentCategory=new d.NI(null),this.categoryValidationStatus$=new _.X(r.Lr.INITIAL)}openRecordList(n){Promise.all([e.e(8592),e.e(3019)]).then(e.bind(e,3019)).then(o=>{this.bottomSheet.show(o.CategoryDiagnosisRecordListComponent,{initialState:{category:n},onClose:()=>this.loader$.next(null)})})}addCategory(){this.alert.input({title:"\uce74\ud14c\uace0\ub9ac \ucd94\uac00",content:"\uc791\ubb3c \uc9c4\ub2e8 \uacb0\uacfc\ub97c \uce74\ud14c\uace0\ub9ac \ubcc4\ub85c \uad00\ub9ac\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4",confirmMessage:"\ucd94\uac00",cancelMessage:"\ucde8\uc18c",placeholder:"\ucd94\uac00\ud560 \uce74\ud14c\uace0\ub9ac \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694. (\ucd5c\ub300 20\uc790)",confirmButtonColor:"green",validators:[d.kI.required,d.kI.maxLength(20)],asyncValidators:[this.categoryNameValidator()],errorMessages:{maxlength:"\uce74\ud14c\uace0\ub9ac \uc774\ub984\uc740 \ucd5c\ub300 20\uc790\uae4c\uc9c0 \uc785\ub825 \uac00\ub2a5\ud569\ub2c8\ub2e4.",alreadyExists:"\uc774\ubbf8 \uc874\uc7ac\ud558\ub294 \uce74\ud14c\uace0\ub9ac\uc785\ub2c8\ub2e4.",validationError:"\uce74\ud14c\uace0\ub9ac \uac80\uc0ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."}}).pipe((0,y.h)(n=>!!n),(0,r.vC)(this.status$),(0,C.w)(n=>this.api.createCategory(n)),(0,l.b)(()=>this.loader$.next(null)),(0,l.b)(()=>this.toast.show("\uce74\ud14c\uace0\ub9ac\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))).subscribe()}editCategory(n,o){o.stopPropagation(),o.preventDefault(),e.e(7938).then(e.bind(e,7938)).then(i=>{this.bottomSheet.show(i.CategoryEditModalComponent,{initialState:{category:n},onClose:()=>this.loader$.next(null)})})}deleteCategory(n,o){o.preventDefault(),o.stopPropagation(),this.alert.confirm({title:"\uce74\ud14c\uace0\ub9ac \uc0ad\uc81c",content:"\uce74\ud14c\uace0\ub9ac\uc5d0 \ud3ec\ud568\ub41c \uc9c4\ub2e8 \uae30\ub85d\uc740 '\ubbf8\ubd84\ub958'\ub85c \ubcc0\uacbd\ub429\ub2c8\ub2e4",confirmMessage:"\uc0ad\uc81c",cancelMessage:"\ucde8\uc18c",confirmButtonColor:"red"}).pipe((0,y.h)(i=>!!i),(0,C.w)(()=>this.api.deleteCategory(n).pipe((0,l.b)(()=>this.toast.show("\uce74\ud14c\uace0\ub9ac\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")),(0,l.b)(()=>this.loader$.next(null))))).subscribe()}categoryNameValidator(){return n=>this.api.loadCategoryByName(n.value).pipe((0,r.Pl)(()=>this.categoryValidationStatus$.next(r.Lr.PENDING)),(0,x.U)(()=>({alreadyExists:{value:n.value}})),(0,l.b)(()=>this.categoryValidationStatus$.next(r.Lr.REJECTED)),(0,f.K)(o=>"CATEGORY_NOT_FOUND"===o.error?.code?(this.categoryValidationStatus$.next(r.Lr.FULFILLED),(0,M.of)(null)):(this.categoryValidationStatus$.next(r.Lr.REJECTED),(0,M.of)({validationError:{value:n.value}}))))}}return a.\u0275fac=function(n){return new(n||a)(t.Y36(O.s),t.Y36(v.BB),t.Y36(p.c9),t.Y36(P.k))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-crop-management"]],standalone:!0,features:[t.qOj,t.jDz],decls:7,vars:6,consts:[[1,"page-title"],["label","\uce74\ud14c\uace0\ub9ac \ucd94\uac00","size","xs","variant","weak","color","gray",3,"click"],["left","","name","add_circle"],["class","category-list",4,"ngIf"],[1,"category-list"],[4,"ngFor","ngForOf"],[1,"category-wrapper",3,"click"],[1,"category-name"],["name","chevron_right","size","24px","color","grayLight"],["class","unclassified-label",4,"ngIf"],["class","action-buttons",4,"ngIf"],[1,"unclassified-label"],[1,"action-buttons"],["label","\uc218\uc815","size","xs","variant","void","color","gray",3,"click"],["left","","name","edit"],["label","\uc0ad\uc81c","size","xs","variant","void","color","redLight",3,"click"],["left","","name","delete"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t._uU(1),t.ALo(2,"categoryName"),t.TgZ(3,"mp-button",1),t.NdJ("click",function(){return o.addCategory()}),t._UZ(4,"mp-icon",2),t.qZA()(),t.YNc(5,B,2,1,"div",3),t.ALo(6,"async")),2&n&&(t.xp6(1),t.hij(" \ub0b4 \uc791\ubb3c \uad00\ub9ac",o.currentCategory.value?" > "+t.lcZ(2,2,o.currentCategory.value):""," "),t.xp6(4),t.Q6J("ngIf",t.lcZ(6,4,o.categories$)))},dependencies:[E.B,m.sg,m.O5,p.zJ,p.gL,p.k_,m.Ov,h.D],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:column;gap:36px;padding:16px}[_nghost-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:24px;color:var(--grayDark);font-weight:600;display:flex;justify-content:space-between;align-items:center}[_nghost-%COMP%]   .category-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-column-gap:16px;grid-row-gap:18px}[_nghost-%COMP%]   .category-list[_ngcontent-%COMP%]   .category-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;box-shadow:0 3px 8px #14141414,0 0 0 1px #1414140f;border-radius:12px;padding:8px 8px 8px 12px;gap:12px;background-color:#ffd33d14;border:1px solid #ceaa31}[_nghost-%COMP%]   .category-list[_ngcontent-%COMP%]   .category-wrapper[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:16px;color:var(--grayDark);font-weight:600;display:flex;align-items:flex-start;justify-content:space-between;gap:6px}[_nghost-%COMP%]   .category-list[_ngcontent-%COMP%]   .category-wrapper[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:3px}[_nghost-%COMP%]   .category-list[_ngcontent-%COMP%]   .category-wrapper[_ngcontent-%COMP%]   .unclassified-label[_ngcontent-%COMP%]{font-size:14px;color:var(--gray);font-weight:500}[_nghost-%COMP%]   .category-list[_ngcontent-%COMP%]   .category-wrapper[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:6px;justify-content:flex-end}']}),a})()}}]);